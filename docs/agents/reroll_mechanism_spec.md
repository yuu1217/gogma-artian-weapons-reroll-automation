# reroll_mechanism_spec

## 概要

本プロジェクトが対象とするゲームにおける、武器へのスキル付与（錬成・傀異錬成などに相当する強化システム）の内部仕様と、それを利用した「厳選表」作成の概念について記載する。

## スキル付与の仕様

### 1. 乱数テーブルの共通性

スキル付与の結果決定に使用される乱数テーブル（内部的な進行カウンター）は、**全ての武器種・属性で共通**である。
すなわち、「現在がテーブルの何番目か」という状態は、プレイヤーデータとして 1 つだけ管理されている。

### 2. テーブルの進行ルール

どの武器、どの属性に対してスキル付与を行っても、1 回付与を実行するたびに共通のテーブルが 1 段階進む。

- 武器 A で付与しても、武器 B で付与しても、内部カウンターは同じように「+1」される。
- 付与結果（出現するスキル）は、「現在のテーブル位置」と「対象の武器種・属性」の組み合わせによって決定される。

### 3. ロールバック（リセット）

セーブを行わずにタイトルに戻り、データをロードすることで、テーブルの進行状態を付与前の状態に戻すことができる。

## 厳選表（乱数調整テーブル）の概念

上記の仕様を利用することで、将来の結果を予知し、最適な付与計画を立てることが可能となる。これを「厳選表」と呼ぶ。

### 作成手順

1.  ある時点でのセーブデータを確保する。
2.  特定の武器（例：火属性弓）で、セーブせずに複数回連続で付与を行い、結果（N 回目に出現したスキル詳細）を記録する。
3.  ロードして状態を巻き戻す。
4.  別の武器（例：火属性太刀）で同様に付与を行い、結果を記録する。
5.  これを必要な武器種・属性の分だけ繰り返す。

### 厳選表の活用

各「回（Step）」において、最も有用な結果が得られる武器を選択して付与を実行する。

- **例**:
  - 1 回目: 火属性弓だと微妙だが、火属性太刀だと神スキルが出る → 太刀で付与を実行してセーブ。
  - 2 回目: どの武器でも不要なスキル → 適当な武器（捨て武器）で付与してテーブルを進める。

## 自動化ツールのスコープ

### 本ツールでの実装方針

- **1 回の実行単位**: 「1 つの武器種・属性」に対する連続付与と結果記録を行う。
  - 複数の武器をまたいだ自動化（ロード～移動～武器変更～付与）はスコープ外とする。
- **データ出力**: 記録した結果は CSV 形式で出力する。
